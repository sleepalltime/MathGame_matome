# 愛米的夢境學堂更新流程

## 更新流程

Unity內輸出流程

![流程圖drawio.png](%E6%B5%81%E7%A8%8B%E5%9C%96drawio.png)

1. 將Unity輸出的apk上傳至Google Cloud，並修改權限為公開
2. 將Unity輸出的exe包壓縮成zip上傳至Google Cloud，並修改權限為公開
3. 版本號 的文件是給電腦版檢查更新用，將文件裡的版本號更新後上傳至Google Cloud，並修改權限為公開
4. 測試完沒問題後，更新Google表單的版本號，完成更新

以2.3版本更新為例：

[https://storage.googleapis.com/aifunupdata/TEST/%E6%9B%B4%E6%96%B0%E6%B5%81%E7%A8%8B%E7%A4%BA%E7%AF%84%E5%BD%B1%E7%89%87/%E6%9B%B4%E6%96%B0%E5%A4%A7%E5%9C%B0%E5%9C%96%E5%A0%B4%E6%99%AF.mp4](https://storage.googleapis.com/aifunupdata/TEST/%E6%9B%B4%E6%96%B0%E6%B5%81%E7%A8%8B%E7%A4%BA%E7%AF%84%E5%BD%B1%E7%89%87/%E6%9B%B4%E6%96%B0%E5%A4%A7%E5%9C%B0%E5%9C%96%E5%A0%B4%E6%99%AF.mp4)

## 小學館、升學館更新

小學館(1~3年級)：Lobby_PrimaryCastle

升學館(4~6年級)：Lobby_PrimaryCastleS2

### 影片更新

在 ScriptableObject 資料夾中可以看到有兩個 ScriptableObject 分別為：SemesterData_Up、SemesterData_Down，Up、Down代表上、下學期（如下圖）

![流程圖1.png](%E6%B5%81%E7%A8%8B%E5%9C%961.png)

---

以 SemesterData_Down 為例

如下圖，從最外層到最內層為：GradeInfo(年級) → CompanyInfo(版本) → CourseInfo(科目) → ClassInfo(課程)

![流程圖2.png](%E6%B5%81%E7%A8%8B%E5%9C%962.png)

如下圖，在ClassInfo中：

- Class Name 是編輯畫面方便辨認用的，不會顯示給使用者看
- Name 是給使用者看的，國文科的這個欄位要填入課文名稱，而數學科則填入第幾課
- Sprite 是放入該版本的預設圖片，會顯示在畫面上
- LibraryNumber 是給評量用的，填入的數字會開啟相對應第幾課的評量
    
    若此欄位填0，表示本課還沒有評量，但會顯示給使用者看(呈暗色、無法點擊)；
    
    若此欄位填-1，表示本課評量不會顯示給使用者看(-1多用於數學科一課多單元時)
    
- YouTubeUrl 是放影片連結
    
    ![流程圖3.png](%E6%B5%81%E7%A8%8B%E5%9C%963.png)
    

### 評量更新

在 Resources 資料夾的 Quiz 資料夾中，一樣用 Up、Down 兩個資料夾代表上、下學期，

依序是版本(HL表示翰林、KX表示康軒、NI表示南一)、年級(1、2、3、4、5、6)、科目(Chinese、Math)，如下圖

![流程圖4.png](%E6%B5%81%E7%A8%8B%E5%9C%964.png)

---

Chinese-1 資料夾中的Prefab需要與資料夾名稱相同 ( 如下圖)

![流程圖5.png](%E6%B5%81%E7%A8%8B%E5%9C%965.png)

---

如下圖及下表，題目Prefab 中，每個欄位分別要填入：

![流程圖6.png](%E6%B5%81%E7%A8%8B%E5%9C%966.png)

| 欄位 | 要填入 | 備註 |
| --- | --- | --- |
| Sprite  | 題目圖片 |  |
| Sprite_A  | 答案圖片 |  |
| Correct  | 答案編號 | 若答案為 A 填入0，B 填入1以此類推 |
| Unit Path | 科目-第幾課 | 如：Chinese-1 或 Math-1，給路徑讀取用 |
| Unit Name | 與影片相同之名稱 | 給使用者看的 |
| Sprite Name | 第幾題的數字 | 以上圖為例，這是第一題 |
| Name | 此題目屬於哪一種題型 |  |

示範影片：

[https://storage.googleapis.com/aifunupdata/TEST/%E6%9B%B4%E6%96%B0%E6%B5%81%E7%A8%8B%E7%A4%BA%E7%AF%84%E5%BD%B1%E7%89%87/%E6%96%B0%E5%A2%9E%E8%A9%95%E9%87%8F.mp4](https://storage.googleapis.com/aifunupdata/TEST/%E6%9B%B4%E6%96%B0%E6%B5%81%E7%A8%8B%E7%A4%BA%E7%AF%84%E5%BD%B1%E7%89%87/%E6%96%B0%E5%A2%9E%E8%A9%95%E9%87%8F.mp4)

---

若有評量需替換，如：113學年度翰林版二上國文第二課是「踩影子」，而在114學年度翰林版二上國文第二課改為「彩色的天空」，因此評量需如下圖做修改

![流程圖11.png](%E6%B5%81%E7%A8%8B%E5%9C%9611.png)

1. 新增一個資料夾，命名為 Old113-2 (Old學年度-第幾課)
2. 將原本 Chinese-2 資料夾內的圖片與 Prefab 移動到 Old113-2 資料夾中
3. 將 Prefab 名字，改為與資料夾名稱相同 Old113-2
4. 在原本 Chinese-2 資料夾中加入新的評量圖片與 Prefab (如下圖)

![流程圖12.png](%E6%B5%81%E7%A8%8B%E5%9C%9612.png)

## 科普島影片更新

科普島：Lobby_PopularScience

示範影片：

[https://storage.googleapis.com/aifunupdata/TEST/%E6%9B%B4%E6%96%B0%E6%B5%81%E7%A8%8B%E7%A4%BA%E7%AF%84%E5%BD%B1%E7%89%87/%E6%96%B0%E5%A2%9E%E7%A7%91%E6%99%AE%E5%B3%B6%E5%BD%B1%E7%89%87.mp4](https://storage.googleapis.com/aifunupdata/TEST/%E6%9B%B4%E6%96%B0%E6%B5%81%E7%A8%8B%E7%A4%BA%E7%AF%84%E5%BD%B1%E7%89%87/%E6%96%B0%E5%A2%9E%E7%A7%91%E6%99%AE%E5%B3%B6%E5%BD%B1%E7%89%87.mp4)

## 大地圖UpdateStagePanel 按鈕編號

以2.3版版更新為例：

下圖是 輕鬆閱讀站 新增的內容，圖中框起來的是需要修改的部分 1_18 (場景編號_故事書編號)，場景編號為固定，只需修改故事書編號就好

![流程圖7.png](%E6%B5%81%E7%A8%8B%E5%9C%967.png)

下圖是 AI升學館 新增的內容，圖中框起來的是需要修改的部分 Five_0_HL_2_0 (年級_科目編號_版本_第幾課_上下學期)，根據這個可以直接開啟指定影片

![流程圖8.png](%E6%B5%81%E7%A8%8B%E5%9C%968.png)

下面將整理 AI小學館 和 AI升學館 影片連結字串的對應

- 年級：One、Two、Three、Four、Five、Six
- 科目編號：0 ⇒ 國文、1 ⇒ 英文、2 ⇒ 數學、3 ⇒ 社會、4 ⇒ 自然
- 版本：HL ⇒ 翰林、KX ⇒ 康軒、NI ⇒ 南一
- 第幾課：0 ⇒ 第一課、1 ⇒ 第二課……
- 上下學期：0 ⇒ 上學期、1 ⇒ 下學期

---

下圖是 趣味科普館 新增的內容，圖中框起來的是將按鈕本身拖入，是將自己本身的子物件順序傳入，用以開啟對應順序的影片(適合用於新增的影片放前面的場景)

![流程圖9.png](%E6%B5%81%E7%A8%8B%E5%9C%969.png)

## 修改Google Cloud權限為公開

示範影片：

[Google Cloud權限修改.mp4](Google_Cloud%E6%AC%8A%E9%99%90%E4%BF%AE%E6%94%B9.mp4)

## Google 表單

修改圖中的版本號欄位後，從 Title 進入遊戲，若有連線可偵測版本更新。

在測試時，開啟APP時更改為新的版本號，在遊戲跳出可更新，並下載更新檔案時，將版本號改為舊的版本號，以避免影響其他使用者

當所有更新測試都完成後，將版本號更新

![流程圖10.png](%E6%B5%81%E7%A8%8B%E5%9C%9610.png)